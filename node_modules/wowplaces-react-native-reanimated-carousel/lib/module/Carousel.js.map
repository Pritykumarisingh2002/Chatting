{"version":3,"names":["React","StyleSheet","runOnJS","useDerivedValue","useAutoPlay","useCarouselController","useCommonVariables","useInitProps","useLayoutConfig","useOnProgressChange","usePropsErrorBoundary","useVisibleRanges","BaseLayout","ScrollViewGesture","CTX","computedRealIndexWithAutoFillData","Carousel","forwardRef","_props","ref","props","testID","loop","autoFillData","data","dataLength","rawData","rawDataLength","mode","style","width","height","vertical","autoPlay","windowSize","autoPlayReverse","autoPlayInterval","scrollAnimationDuration","withAnimation","renderItem","onScrollEnd","onSnapToItem","onScrollBegin","onProgressChange","customAnimation","defaultIndex","commonVariables","size","handlerOffset","offsetX","totalSize","x","value","isNaN","carouselController","_onScrollEnd","duration","next","prev","scrollTo","getSharedIndex","getCurrentIndex","start","startAutoPlay","pause","pauseAutoPlay","useCallback","_sharedIndex","Math","round","realIndex","index","scrollViewGestureOnScrollBegin","scrollViewGestureOnScrollEnd","scrollViewGestureOnTouchBegin","scrollViewGestureOnTouchEnd","useImperativeHandle","visibleRanges","total","viewSize","translation","layoutConfig","renderLayout","item","i","createElement","key","animationStyle","_ref","animationValue","Provider","common","styles","container","itemsVertical","itemsHorizontal","onTouchBegin","onTouchEnd","map","create","overflow","flexDirection"],"sources":["Carousel.tsx"],"sourcesContent":["/* eslint-disable @typescript-eslint/no-use-before-define */\nimport React from \"react\";\nimport { StyleSheet } from \"react-native\";\nimport { runOnJS, useDerivedValue } from \"react-native-reanimated\";\n\nimport { useAutoPlay } from \"./hooks/useAutoPlay\";\nimport { useCarouselController } from \"./hooks/useCarouselController\";\nimport { useCommonVariables } from \"./hooks/useCommonVariables\";\nimport { useInitProps } from \"./hooks/useInitProps\";\nimport { useLayoutConfig } from \"./hooks/useLayoutConfig\";\nimport { useOnProgressChange } from \"./hooks/useOnProgressChange\";\nimport { usePropsErrorBoundary } from \"./hooks/usePropsErrorBoundary\";\nimport { useVisibleRanges } from \"./hooks/useVisibleRanges\";\nimport { BaseLayout } from \"./layouts/BaseLayout\";\nimport { ScrollViewGesture } from \"./ScrollViewGesture\";\nimport { CTX } from \"./store\";\nimport type { ICarouselInstance, TCarouselProps } from \"./types\";\nimport { computedRealIndexWithAutoFillData } from \"./utils/computedWithAutoFillData\";\n\nconst Carousel = React.forwardRef<ICarouselInstance, TCarouselProps<any>>(\n  (_props, ref) => {\n    const props = useInitProps(_props);\n\n    const {\n      testID,\n      loop,\n      autoFillData,\n      // Fill data with autoFillData\n      data,\n      // Length of fill data\n      dataLength,\n      // Raw data that has not been processed\n      rawData,\n      // Length of raw data\n      rawDataLength,\n      mode,\n      style,\n      width,\n      height,\n      vertical,\n      autoPlay,\n      windowSize,\n      autoPlayReverse,\n      autoPlayInterval,\n      scrollAnimationDuration,\n      withAnimation,\n      renderItem,\n      onScrollEnd,\n      onSnapToItem,\n      onScrollBegin,\n      onProgressChange,\n      customAnimation,\n      defaultIndex,\n    } = props;\n\n    const commonVariables = useCommonVariables(props);\n    const { size, handlerOffset } = commonVariables;\n\n    const offsetX = useDerivedValue(() => {\n      const totalSize = size * dataLength;\n      const x = handlerOffset.value % totalSize;\n\n      if (!loop)\n        return handlerOffset.value;\n\n      return isNaN(x) ? 0 : x;\n    }, [loop, size, dataLength]);\n\n    usePropsErrorBoundary({ ...props, dataLength });\n    useOnProgressChange({\n      autoFillData,\n      loop,\n      size,\n      offsetX,\n      rawDataLength,\n      onProgressChange,\n    });\n\n    const carouselController = useCarouselController({\n      loop,\n      size,\n      dataLength,\n      autoFillData,\n      handlerOffset,\n      withAnimation,\n      defaultIndex,\n      onScrollEnd: () => runOnJS(_onScrollEnd)(),\n      onScrollBegin: () => !!onScrollBegin && runOnJS(onScrollBegin)(),\n      duration: scrollAnimationDuration,\n    });\n\n    const { next, prev, scrollTo, getSharedIndex, getCurrentIndex }\n            = carouselController;\n\n    const { start: startAutoPlay, pause: pauseAutoPlay } = useAutoPlay({\n      autoPlay,\n      autoPlayInterval,\n      autoPlayReverse,\n      carouselController,\n    });\n\n    const _onScrollEnd = React.useCallback(() => {\n      const _sharedIndex = Math.round(getSharedIndex());\n\n      const realIndex = computedRealIndexWithAutoFillData({\n        index: _sharedIndex,\n        dataLength: rawDataLength,\n        loop,\n        autoFillData,\n      });\n\n      if (onSnapToItem)\n        onSnapToItem(realIndex);\n\n      if (onScrollEnd)\n        onScrollEnd(realIndex);\n    }, [\n      loop,\n      autoFillData,\n      rawDataLength,\n      getSharedIndex,\n      onSnapToItem,\n      onScrollEnd,\n    ]);\n\n    const scrollViewGestureOnScrollBegin = React.useCallback(() => {\n      pauseAutoPlay();\n      onScrollBegin?.();\n    }, [onScrollBegin, pauseAutoPlay]);\n\n    const scrollViewGestureOnScrollEnd = React.useCallback(() => {\n      startAutoPlay();\n      _onScrollEnd();\n    }, [_onScrollEnd, startAutoPlay]);\n\n    const scrollViewGestureOnTouchBegin = React.useCallback(pauseAutoPlay, [\n      pauseAutoPlay,\n    ]);\n\n    const scrollViewGestureOnTouchEnd = React.useCallback(startAutoPlay, [\n      startAutoPlay,\n    ]);\n\n    React.useImperativeHandle(\n      ref,\n      () => ({\n        next,\n        prev,\n        getCurrentIndex,\n        scrollTo,\n      }),\n      [getCurrentIndex, next, prev, scrollTo],\n    );\n\n    const visibleRanges = useVisibleRanges({\n      total: dataLength,\n      viewSize: size,\n      translation: handlerOffset,\n      windowSize,\n    });\n\n    const layoutConfig = useLayoutConfig({ ...props, size });\n\n    const renderLayout = React.useCallback(\n      (item: any, i: number) => {\n        const realIndex = computedRealIndexWithAutoFillData({\n          index: i,\n          dataLength: rawDataLength,\n          loop,\n          autoFillData,\n        });\n\n        return (\n          <BaseLayout\n            key={i}\n            index={i}\n            handlerOffset={offsetX}\n            visibleRanges={visibleRanges}\n            animationStyle={customAnimation || layoutConfig}\n          >\n            {({ animationValue }) =>\n              renderItem({\n                item,\n                index: realIndex,\n                animationValue,\n              })\n            }\n          </BaseLayout>\n        );\n      },\n      [\n        loop,\n        rawData,\n        offsetX,\n        visibleRanges,\n        autoFillData,\n        renderItem,\n        layoutConfig,\n        customAnimation,\n      ],\n    );\n\n    return (\n      <CTX.Provider value={{ props, common: commonVariables }}>\n        <ScrollViewGesture\n          key={mode}\n          size={size}\n          translation={handlerOffset}\n          style={[\n            styles.container,\n            {\n              width: width || \"100%\",\n              height: height || \"100%\",\n            },\n            style,\n            vertical\n              ? styles.itemsVertical\n              : styles.itemsHorizontal,\n          ]}\n          testID={testID}\n          onScrollBegin={scrollViewGestureOnScrollBegin}\n          onScrollEnd={scrollViewGestureOnScrollEnd}\n          onTouchBegin={scrollViewGestureOnTouchBegin}\n          onTouchEnd={scrollViewGestureOnTouchEnd}\n        >\n          {data.map(renderLayout)}\n        </ScrollViewGesture>\n      </CTX.Provider>\n    );\n  },\n);\n\nexport default Carousel as <T extends any>(\n  props: React.PropsWithChildren<TCarouselProps<T>>\n) => React.ReactElement;\n\nconst styles = StyleSheet.create({\n  container: {\n    overflow: \"hidden\",\n  },\n  itemsHorizontal: {\n    flexDirection: \"row\",\n  },\n  itemsVertical: {\n    flexDirection: \"column\",\n  },\n});\n"],"mappings":"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"}